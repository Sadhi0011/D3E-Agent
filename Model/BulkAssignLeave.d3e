(Model BulkAssignLeave {
    name 'Bulk Assign Leave'
    
    master #Company
    package 'rewa.hr.2'
    properties [
        (comment {
            name 'Comment'
            type ({
                primitive String
            })
            longText true
        })
        (leaveBalance {
            name 'Leave Balance'
            type ({
                primitive Double
            })
        })
        (toDate {
            name 'To Date'
            type ({
                primitive Date
            })
            required true
        })
        (fromDate {
            name 'From Date'
            type ({
                primitive Date
            })
            required true
        })
        (leaveType {
            name 'Leave Type'
            type ({
                model #LeaveType
            })
            required true
            referenceFrom `this.company.leaveTypes`
        })
        (duration {
            name 'Duration'
            type ({
                optionSet #LeaveDuration
            })
            existsIf `toDate.day - fromDate.day == 1 && this.partialDays == PartialDays.AllDays`
        })
        (fromTime {
            name 'From Time'
            type ({
                primitive Time
            })
            existsIf `this.duration == LeaveDuration.SpecifyTime || this.startDay == LeaveDuration.SpecifyTime || this.endDay == LeaveDuration.SpecifyTime `
            required true
        })
        (toTime {
            name 'To Time'
            type ({
                primitive Time
            })
            existsIf `this.duration ==LeaveDuration.SpecifyTime || this.startDay == LeaveDuration.SpecifyTime || this.endDay == LeaveDuration.SpecifyTime `
            required true
        })
        (durationTime {
            name 'Duration Time'
            type ({
                primitive Integer
            })
            existsIf `this.duration == LeaveDuration.SpecifyTime || this.startDay == LeaveDuration.SpecifyTime || this.endDay == LeaveDuration.SpecifyTime `
        })
        (status {
            name 'Status'
            type ({
                optionSet #LeaveStatus
            })
        })
        (employees {
            name 'Employees'
            type ({
                model #Employee
            })
            collection true
            readType ReadOnly
        })
        (partialDays {
            name 'Partial Days'
            type ({
                optionSet #PartialDays
            })
            existsIf `toDate.day - fromDate.day > 1`
        })
        (dayType {
            name 'Day Type'
            type ({
                optionSet #DayType
            })
            existsIf `this.partialDays != PartialDays.None`
        })
       (startMorningHalf {
            name 'Start Morning Half'
            type ({
                primitive Boolean
            })
            existsIf `this.duration == HalfDay`
        })
        (endMorningHalf {
            name 'End Morning Half'
            type ({
                primitive Boolean
            })
            existsIf `this.duration == HalfDay`
        })
        (startDay {
            name 'Start Day'
            type ({
                optionSet #LeaveDuration
            })
            existsIf `this.partialDays == PartialDays.StartDayOnly || this.partialDays  == PartialDays.StartAndEndDay`
        })
        (endDay {
            name 'End Day'
            type ({
                optionSet #LeaveDuration
            })
            existsIf `this.partialDays  == PartialDays.EndDayOnly || this.partialDays  == PartialDays.StartAndEndDay`
        })
        (numberOfDays {
            name 'Number Of Days'
            type ({
                primitive Double
            })
            readType ReadOnly
        })
        (location {
            name 'Location'
            type ({
                model #Location
            })
        })
        (subUnit {
            name 'Sub Unit'
            type ({
                model #SubUnit
            })
        })
        (addtionalEmployees {
            name 'Addtional Employees'
            collection true
            type ({
                model #Employee
            })
        })
    ]
    actions [
        (LeaveCreate {
            name 'leaveCreate'
             block ```
                List<Employee> allEmployees = this.employees;
                allEmployees.addAll(this.addtionalEmployees);
                for(Employee emp in allEmployees){
                    LeaveRequest request = LeaveRequest(
                        employee : emp,
                        leaveType : leaveType,
                        fromDate : fromDate,
                        toDate : toDate,
                        allDuration : duration,
                        status : Approved,
                        partialDays : partialDays,
                        startDuration : startDay,
                        endDuration : endDay,
                        allPartialFrom : fromTime,
                        allPartialTo : toTime,
                        initalComment : comment,
                    );
                    Database.save(request);
                }
            ```
        })
        
    ]
    transient true
})